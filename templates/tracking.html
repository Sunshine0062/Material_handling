<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ | ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏ï‡πá‡∏≠‡∏Å</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Prompt', sans-serif;
        }
        .table-scroll {
            max-height: 240px;
            overflow-y: auto;
        }
        table {
            border-collapse: collapse;
            width: 100%;
        }
        thead tr th {
            position: sticky;
            top: 0;
            background-color: #fff;
            z-index: 10;
            border-bottom: 2px solid #f97316;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">

    <nav class="bg-white shadow sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <div class="bg-orange-500 w-10 h-10 rounded-md flex items-center justify-center text-white font-bold">üèóÔ∏è</div>
                <span class="text-lg font-semibold text-gray-800">‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span>
            </div>
            <a href="{{ url_for('dashboard') }}" class="text-sm text-orange-600 hover:underline">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto px-4 py-10 space-y-10">

        <!-- ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ -->
        <section>
            <h2 class="text-xl font-bold text-gray-800 mb-4">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</h2>
            <div class="bg-white shadow rounded-lg overflow-x-auto">
                <div class="table-scroll">
                    <table class="min-w-full text-sm text-left">
                        <thead class="bg-orange-50 text-orange-700">
                            <tr>
                                <th class="px-4 py-2">‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏∏</th>
                                <th class="px-4 py-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏™‡∏î‡∏∏</th>
                                <th class="px-4 py-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
                                <th class="px-4 py-2">‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for m in materials %}
                            <tr class="border-t hover:bg-orange-50">
                                <td class="px-4 py-2 font-mono">{{ m.code }}</td>
                                <td class="px-4 py-2">{{ m.name }}</td>
                                <td class="px-4 py-2 {% if m.quantity < 10 %}text-red-600 font-semibold{% endif %}">{{ m.quantity }}</td>
                                <td class="px-4 py-2">{{ m.unit }}</td>
                            </tr>
                            {% else %}
                            <tr><td colspan="4" class="text-center text-gray-500 py-4">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
        <section>
            <h2 class="text-xl font-bold text-gray-800 mb-4">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>

            <!-- ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á -->
            <form id="filterForm" class="bg-white p-4 rounded-lg shadow mb-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3 items-end">
                <div>
                    <label for="startDate" class="block text-gray-600 text-sm mb-1">‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà</label>
                    <input type="date" id="startDate" name="startDate"
                        class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:ring-orange-400 focus:outline-none" />
                </div>
                <div>
                    <label for="endDate" class="block text-gray-600 text-sm mb-1">‡∏ñ‡∏∂‡∏á</label>
                    <input type="date" id="endDate" name="endDate"
                        class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:ring-orange-400 focus:outline-none" />
                </div>
                <div>
                    <label for="typeFilter" class="block text-gray-600 text-sm mb-1">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
                    <select id="typeFilter" name="typeFilter"
                        class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:ring-orange-400 focus:outline-none">
                        <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                        <option value="in">‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤</option>
                        <option value="out">‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏≠‡∏Å</option>
                    </select>
                </div>
                <div>
                    <label class="block text-white text-sm mb-1 select-none">‡∏•‡πâ‡∏≤‡∏á</label>
                    <button type="button" id="clearFilters"
                        class="w-full bg-gray-300 hover:bg-gray-400 text-gray-800 px-2 py-1 text-sm rounded">‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</button>
                </div>
            </form>

            <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ -->
            <div class="bg-white shadow rounded-lg overflow-x-auto">
                <div class="table-scroll">
                    <table id="logsTable" class="min-w-full text-sm text-left">
                        <thead class="bg-orange-50 text-orange-700">
                            <tr>
                                <th class="px-4 py-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th class="px-4 py-2">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                                <th class="px-4 py-2">‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏∏</th>
                                <th class="px-4 py-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏™‡∏î‡∏∏</th>
                                <th class="px-4 py-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                                <th class="px-4 py-2">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for log in logs|reverse %}
                            <tr class="border-t hover:bg-orange-50" data-type="{{ log.type }}" data-date="{{ log.date }}">
                                <td class="px-4 py-2">{{ log.date }}</td>
                                <td class="px-4 py-2 font-medium {{ 'text-green-600' if log.type == 'in' else 'text-red-600' }}">
                                    {{ '‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤' if log.type == 'in' else '‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏≠‡∏Å' }}
                                </td>
                                <td class="px-4 py-2 font-mono">{{ log.code }}</td>
                                <td class="px-4 py-2">{{ log.name }}</td>
                                <td class="px-4 py-2">{{ log.quantity }}</td>
                                <td class="px-4 py-2">
                                    {% if log.type == 'out' %}
                                        ‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å: {{ log.requester }} | ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£: {{ log.project }}
                                    {% else %}
                                        -
                                    {% endif %}
                                </td>
                            </tr>
                            {% else %}
                            <tr><td colspan="6" class="text-center text-gray-500 py-4">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î -->
        <section>
            <h2 class="text-xl font-bold text-red-600 mb-4">‚ö†Ô∏è ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î (‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 10)</h2>
            <div class="bg-white shadow rounded-lg overflow-x-auto">
                <div class="table-scroll">
                    <table class="min-w-full text-sm text-left">
                        <thead class="bg-red-50 text-red-700">
                            <tr>
                                <th class="px-4 py-2">‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏∏</th>
                                <th class="px-4 py-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏™‡∏î‡∏∏</th>
                                <th class="px-4 py-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                                <th class="px-4 py-2">‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for m in materials if m.quantity < 10 %}
                            <tr class="border-t hover:bg-red-50">
                                <td class="px-4 py-2 font-mono">{{ m.code }}</td>
                                <td class="px-4 py-2">{{ m.name }}</td>
                                <td class="px-4 py-2 font-bold">{{ m.quantity }}</td>
                                <td class="px-4 py-2">{{ m.unit }}</td>
                            </tr>
                            {% else %}
                            <tr><td colspan="4" class="text-center text-gray-500 py-4">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

    </main>

<script>
    const filterForm = document.getElementById('filterForm');
    const logsTable = document.getElementById('logsTable');
    const clearBtn = document.getElementById('clearFilters');

    function filterLogs() {
        const startDate = filterForm.startDate.value;
        const endDate = filterForm.endDate.value;
        const typeFilter = filterForm.typeFilter.value;

        const rows = logsTable.tBodies[0].rows;
        for (let row of rows) {
            const rowDate = row.getAttribute('data-date');
            const rowType = row.getAttribute('data-type');

            let show = true;

            if (startDate && rowDate < startDate) show = false;
            if (endDate && rowDate > endDate) show = false;
            if (typeFilter !== 'all' && rowType !== typeFilter) show = false;

            row.style.display = show ? '' : 'none';
        }
    }

    filterForm.addEventListener('change', filterLogs);

    clearBtn.addEventListener('click', () => {
        filterForm.startDate.value = '';
        filterForm.endDate.value = '';
        filterForm.typeFilter.value = 'all';
        filterLogs();
    });

    filterLogs();
</script>

</body>
</html>
